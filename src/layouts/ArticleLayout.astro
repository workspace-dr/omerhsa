---
import MainLayout from './MainLayout.astro';
import { Image } from 'astro:assets'; // Si usas assets locales
// Importa getCollection para los sugeridos
import { getCollection } from 'astro:content';

interface Props {
  frontmatter: {
    title: string;
    description?: string;
    publishDate: Date;
    author?: string;
    image?: string;
    tags?: string[];
  };
}

const { frontmatter } = Astro.props;

// Obtener 2 posts sugeridos (excluyendo el actual idealmente, pero simplificado aquí)
const allPosts = await getCollection('blog');
const suggestedPosts = allPosts.slice(0, 2); 
---

<MainLayout title={frontmatter.title} description={frontmatter.description}>
  
  {/* Header del Artículo */}
  <header class="pt-32 pb-12 bg-gray-50 text-center px-4">
    <div class="max-w-4xl mx-auto">
      <div class="flex items-center justify-center gap-4 text-sm text-gray-500 mb-6">
        <time datetime={frontmatter.publishDate.toISOString()}>
          {frontmatter.publishDate.toLocaleDateString('es-HN', { dateStyle: 'long' })}
        </time>
        <span>•</span>
        <span class="font-bold text-omerhsa-primary">{frontmatter.author}</span>
      </div>
      <h1 class="text-3xl md:text-5xl font-bold text-gray-900 mb-8 leading-tight">{frontmatter.title}</h1>
      
      {frontmatter.tags && (
        <div class="flex flex-wrap justify-center gap-2">
          {frontmatter.tags.map(tag => (
            <span class="bg-white border border-gray-200 px-3 py-1 rounded-full text-xs font-bold text-gray-600">
              #{tag}
            </span>
          ))}
        </div>
      )}
    </div>
  </header>

  {/* Imagen Principal (si existe) */}
  {frontmatter.image && (
    <div class="max-w-5xl mx-auto px-4 sm:px-6 -mt-8 mb-12 relative z-10">
      <img src={frontmatter.image} alt={frontmatter.title} class="w-full h-auto rounded-3xl shadow-xl" />
    </div>
  )}

  {/* Contenido Markdown (Tipografía mejorada) */}
  <article class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">
    <div class="prose prose-lg prose-blue max-w-none prose-headings:font-bold prose-headings:text-gray-900 prose-p:text-gray-600 prose-img:rounded-2xl">
      <slot />
    </div>
  </article>

  {/* Sección de "Leer más" */}
  <section class="bg-gray-100 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h3 class="text-2xl font-bold text-gray-900 mb-8">También podría interesarte</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {suggestedPosts.map(post => (
          <a href={`/blog/${post.slug}`} class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition-all group flex items-center gap-6">
             {post.data.image && (
               <img src={post.data.image} alt={post.data.title} class="w-24 h-24 rounded-xl object-cover" />
             )}
             <div>
               <h4 class="font-bold text-gray-900 group-hover:text-omerhsa-primary transition-colors mb-2">
                 {post.data.title}
               </h4>
               <p class="text-xs text-gray-500">{post.data.publishDate.toLocaleDateString()}</p>
             </div>
          </a>
        ))}
      </div>
    </div>
  </section>

</MainLayout>